class CloneFormFields{constructor(l,n){this.fields=document.querySelectorAll(l),this.addButtonElement=null,this.options={buttonText:"Hinzuf\xFCgen",buttonRemoveText:"Feldgruppe l\xF6schen"},this.settings=this.merge(this.options,n),this.addButton()}addButton(){let l=this.fields[this.fields.length-1];this.addButtonElement=this.createElement({tag:"span",className:"btn btn-blue-text",innerText:this.settings.buttonText,role:"button",tabIndex:0},l,"afterend"),this.addButtonElement.addEventListener("click",()=>this.cloneFields()),this.addButtonElement.addEventListener("keydown",n=>{n.key==="Enter"&&n.preventDefault()})}cloneFields(){let l=document.querySelectorAll('[class*="cloned-fields-"]').length+1,n=this.createElement({tag:"div",className:`cloned-fields-${l}`},this.addButtonElement,"beforebegin");this.fields.forEach(e=>{let r;e.tagName.toLowerCase()==="label"?(r=e.cloneNode(!0),r.htmlFor&&(r.htmlFor+=`_${l}`)):(r=e.cloneNode(!0),r.id&&(r.id=r.id.replace(/_[0-9]+$/,"")+`_${l}`,r.value="")),n.appendChild(r)});let s=this.createElement({tag:"span",role:"button",tabIndex:0,className:"btn delete-btn",innerText:this.settings.buttonRemoveText},n,"beforeend");s.addEventListener("click",()=>{n.remove(),this.reorderContainers()}),s.addEventListener("keydown",e=>{e.key==="Enter"&&e.preventDefault()});const t=n.querySelector('input:not([type="hidden"]), select, textarea');t&&t.focus()}reorderContainers(){document.querySelectorAll('[class*="cloned-fields-"]').forEach((n,s)=>{let t=s+1;n.className=`cloned-fields-${t}`,n.querySelectorAll("label").forEach(e=>{e.htmlFor&&(e.htmlFor=e.htmlFor.replace(/_[0-9]+$/,"")+`_${t}`)}),n.querySelectorAll("[id]").forEach(e=>{e.id=e.id.replace(/_[0-9]+$/,"")+`_${t}`})}),this.addButtonElement.focus()}createElement(l,n,s="beforeend"){let t=document.createElement(l.tag),e=l?.dataset?l.dataset:!1;delete l.tag,delete l.dataset;for(let r in l)t[r]=l[r];if(e)for(let r in e)t.dataset[r]=e[r];return n.insertAdjacentElement(s,t),t}merge(...l){let n={};const s=t=>{for(let e in t)t.hasOwnProperty(e)&&(Object.prototype.toString.call(t[e])==="[object Object]"?n[e]=this.merge(n[e],t[e]):n[e]=t[e])};for(let t=0;t<l.length;t++)s(l[t]);return n}}
